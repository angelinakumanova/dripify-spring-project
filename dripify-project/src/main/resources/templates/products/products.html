<!DOCTYPE html>
<html lang="en" style="font-size: 16px;">

<head th:replace="~{/fragments/head::head(pageName=${currentCategory.toUpperCase()})}">

<body class="flex flex-col min-h-screen">
<div th:replace="~{/fragments/nav::nav}"></div>

<div class="main-site-content lg:mt-24">
    <div class="flex flex-col lg:flex-row gap-2 mx-auto max-w-2xl px-4 py-16 sm:px-6 sm:py-24 lg:max-w-screen-2xl lg:px-8">
        <div class="lg:border-r-2 lg:pr-3">
            <div class="w-full lg:w-48 whitespace-nowrap p-3 border-2 border-opacity-50 rounded-3xl">

                <!-- Women Categories -->
                <div class="p-2" th:with="isWomenPath=${currentPath.contains('/products/women/')}">
                    <button type="button"
                            th:classappend="${isWomenPath} ?
                               'font-bold text-gray-800' : 'font-medium text-gray-600'"
                            class="categories-toggle-btn mb-2 text-2xl hover:text-gray-800">Women
                    </button>
                    <ul th:classappend="${!isWomenPath} ? 'hidden' : ''"
                        class="space-y-2 text-base font-semibold uppercase">
                        <hr>

                        <li th:each="category: ${categories}"
                            th:with="isActivePath=${#uris.unescapePath(currentPath).contains('/products/women/' + category.name)}"
                            th:if="${category.gender.equals(T(com.dripify.shared.enums.Gender).WOMEN)
                                   || category.gender.equals(T(com.dripify.shared.enums.Gender).UNISEX)}">

                            <a th:href="@{'/products/women/' + ${category.name}}"
                               th:classappend="${isActivePath} ?'font-bold text-zinc-800' : 'text-zinc-600'"
                               th:text="${category.name}"
                               class="uppercase transition duration-200 ease-in hover:text-white
                                 hover:bg-zinc-400 p-1 px-2 rounded-2xl"></a>


                            <ul th:if="${not #lists.isEmpty(category.subcategories) and isActivePath}"
                                class="mt-1">

                                <li th:each="subcategory: ${category.subcategories}"
                                    th:with="subcategoryPath=${'/products/women/' + category.name + '/' + subcategory.name}"
                                    class="indent-3">

                                    <a th:href="@{${subcategoryPath}}"
                                       th:classappend="${#uris.unescapePath(currentPath).equals(subcategoryPath)} ?
                                             'font-bold text-gray-800' : 'text-gray-600'"
                                       th:text="${subcategory.name}"
                                       class="uppercase transition duration-200 ease-in hover:text-white
                                             hover:bg-zinc-400 p-1 px-2 rounded-2xl"></a>
                                </li>

                            </ul>
                        </li>
                    </ul>
                </div>

                <!-- Men Categories -->
                <div class="p-2" th:with="isMenPath=${currentPath.contains('/products/men/')}">
                    <button type="button"
                            th:classappend="${isMenPath} ?
                               'font-bold text-gray-800' : 'font-medium text-gray-600'"
                            class="categories-toggle-btn mb-2 text-2xl hover:text-gray-800">Men
                    </button>
                    <ul th:classappend="${!isMenPath} ? 'hidden' : ''"
                        class="space-y-2 text-base font-semibold uppercase">
                        <hr>

                        <li th:each="category: ${categories}"
                            th:with="isActivePath=${#uris.unescapePath(currentPath).contains('/products/men/' + category.name)}"
                            th:if="${category.gender.equals(T(com.dripify.shared.enums.Gender).MEN)
                                   || category.gender.equals(T(com.dripify.shared.enums.Gender).UNISEX)}">

                            <a th:href="@{'/products/men/' + ${category.name}}"
                               th:classappend="${isActivePath} ?'font-bold text-zinc-800' : 'text-zinc-600'"
                               th:text="${category.name}"
                               class="uppercase transition duration-200 ease-in hover:text-white
                                 hover:bg-zinc-400 p-1 px-2 rounded-2xl"></a>


                            <ul th:if="${not #lists.isEmpty(category.subcategories) and isActivePath}"
                                class="mt-1">

                                <li th:each="subcategory: ${category.subcategories}"
                                    th:with="subcategoryPath=${'/products/men/' + category.name + '/' + subcategory.name}"
                                    class="indent-3">

                                    <a th:href="@{${subcategoryPath}}"
                                       th:classappend="${#uris.unescapePath(currentPath).equals(subcategoryPath)} ?
                                             'font-bold text-gray-800' : 'text-gray-600'"
                                       th:text="${subcategory.name}"
                                       class="uppercase transition duration-200 ease-in hover:text-white
                                             hover:bg-zinc-400 p-1 px-2 rounded-2xl"></a>
                                </li>

                            </ul>
                        </li>
                    </ul>
                </div>

                <!--  Unisex Categories-->
                <div class="p-2" th:with="isUnisexPath=${currentPath.contains('/products/unisex/')}">
                    <button type="button"
                            th:classappend="${isUnisexPath} ?
                               'font-bold text-gray-800' : 'font-medium text-gray-600'"
                            class="categories-toggle-btn mb-2 text-2xl hover:text-gray-800">Unisex
                    </button>
                    <ul th:classappend="${!isUnisexPath} ? 'hidden' : ''"
                        class="space-y-2 text-base font-semibold uppercase">
                        <hr>

                        <li th:each="category: ${categories}"
                            th:with="isActivePath=${#uris.unescapePath(currentPath).contains('/products/unisex/' + category.name)}"
                            th:if="${category.gender.equals(T(com.dripify.shared.enums.Gender).UNISEX)}">

                            <a th:href="@{'/products/unisex/' + ${category.name}}"
                               th:classappend="${isActivePath} ?'font-bold text-zinc-800' : 'text-zinc-600'"
                               th:text="${category.name}"
                               class="uppercase transition duration-200 ease-in hover:text-white
                                 hover:bg-zinc-400 p-1 px-2 rounded-2xl"></a>


                            <ul th:if="${not #lists.isEmpty(category.subcategories) and isActivePath}"
                                class="mt-1">

                                <li th:each="subcategory: ${category.subcategories}"
                                    th:with="subcategoryPath=${'/products/unisex/' + category.name + '/' + subcategory.name}"
                                    class="indent-3">

                                    <a th:href="@{${subcategoryPath}}"
                                       th:classappend="${#uris.unescapePath(currentPath).equals(subcategoryPath)} ?
                                             'font-bold text-gray-800' : 'text-gray-600'"
                                       th:text="${subcategory.name}"
                                       class="uppercase transition duration-200 ease-in hover:text-white
                                             hover:bg-zinc-400 p-1 px-2 rounded-2xl"></a>
                                </li>

                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

        </div>


        <div class="flex-grow">

            <div class="p-2 pl-3 ml-1">
                <div class="flex xl:flex-row flex-col justify-between">

                    <div>
                        <h2 class="text-3xl font-bold
                             tracking-tight uppercase
                             bg-zinc-900 text-white p-2 px-5 rounded-full inline-block"
                            th:text="${currentCategory}"></h2>

                        <h3 class="text-xl p-2 uppercase font-bold"
                            th:text="${productPage.getTotalElements() + ' products found'}"></h3>
                    </div>


                    <div class="w-full xl:w-[55%]">
                        <form class="lg:flex gap-2 grid grid-cols-2" id="form-filter" th:action="@{${currentPath}}" th:method="GET" th:object="${productFilter}">

                            <div class="material relative w-full">
                                <select th:field="*{materials}" name="materials" data-hs-select='{
                                  "toggleTag": "<button type=\"button\" aria-expanded=\"false\" class=\"flex justify-between items-center w-full\"> <span class=\"truncate\" data-title></span> <svg class=\"shrink-0 size-4 text-gray-600 \" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"/></svg> </button>",
                                  "toggleClasses": "duration-300 ease-in-out hover:cursor-pointer hover:border-zinc-700 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 p-2 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border-2 border-opacity-60 font-bold rounded-full focus:outline-none",
                                  "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300",
                                  "optionClasses": "py-2 px-4 w-full text-sm text-nowrap text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50",
                                  "optionTemplate": "<div class=\"flex justify-between items-center w-full\"><span class=\"truncate\" data-title></span><span class=\"hidden hs-selected:block\"><svg class=\"shrink-0 size-3.5 text-blue-600 dark:text-blue-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"/></svg></span></div>",
                                  "extraMarkup": "",
                                  "fixedWidth": true
                              }' class="hidden w-full" multiple>
                                    <option th:each="material: ${T(com.dripify.product.model.enums.Material).values()}"
                                            th:value="${material.name()}"
                                            th:text="${material}"></option>

                                </select>
                                <h1 class="pointer-events-none pl-2 font-bold uppercase absolute bottom-10 left-2 top-1.5">Material</h1>

                            </div>


                            <div class="color relative w-full">
                                <select th:field="*{colors}" name="colors" data-hs-select='{
                                  "toggleTag": "<button type=\"button\" aria-expanded=\"false\" class=\"flex justify-between items-center w-full\"> <span class=\"truncate\" data-title></span> <svg class=\"shrink-0 size-4 text-gray-600 \" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"/></svg> </button>",
                                  "toggleClasses": "duration-300 ease-in-out hover:cursor-pointer hover:border-zinc-700 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 p-2 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border-2 border-opacity-60 font-bold rounded-full focus:outline-none",
                                  "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300",
                                  "optionClasses": "py-2 px-4 w-full text-sm text-nowrap text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50",
                                  "optionTemplate": "<div class=\"flex justify-between items-center w-full\"><span class=\"truncate\" data-title></span><span class=\"hidden hs-selected:block\"><svg class=\"shrink-0 size-3.5 text-blue-600 dark:text-blue-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"/></svg></span></div>",
                                  "extraMarkup": "",
                                  "fixedWidth": true
                              }' class="hidden w-full" multiple>
                                    <option th:each="color: ${T(com.dripify.product.model.enums.Color).values()}"
                                            th:value="${color.name()}"
                                            th:text="${color}"></option>

                                </select>
                                <h1 class="pointer-events-none pl-2 font-bold uppercase absolute bottom-10 left-2 top-1.5">Color</h1>

                            </div>

                            <div class="brand relative w-full">
                                <select th:field="*{brands}" name="brands" data-hs-select='{
                                  "toggleTag": "<button type=\"button\" aria-expanded=\"false\" class=\"flex justify-between items-center w-full\"> <span class=\"truncate\" data-title></span> <svg class=\"shrink-0 size-4 text-gray-600 \" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"/></svg> </button>",
                                  "toggleClasses": "duration-300 ease-in-out hover:cursor-pointer hover:border-zinc-700 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 p-2 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border-2 border-opacity-60 font-bold rounded-full focus:outline-none",
                                  "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300",
                                  "optionClasses": "py-2 px-4 w-full text-sm text-nowrap text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50",
                                  "optionTemplate": "<div class=\"flex justify-between items-center w-full\"><span class=\"truncate\" data-title></span><span class=\"hidden hs-selected:block\"><svg class=\"shrink-0 size-3.5 text-blue-600 dark:text-blue-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"/></svg></span></div>",
                                  "extraMarkup": "",
                                  "fixedWidth": true
                              }' class="hidden w-full" multiple>
                                    <option th:each="brand: ${T(com.dripify.product.model.enums.Brand).values()}"
                                            th:value="${brand.name()}"
                                            th:text="${brand}"></option>

                                </select>
                                <h1 class="pointer-events-none pl-2 font-bold uppercase absolute bottom-10 left-2 top-1.5">Brand</h1>

                            </div>


                            <div class="size relative w-full">
                                <select th:field="*{sizes}" name="sizes" data-hs-select='{
                                  "toggleTag": "<button type=\"button\" aria-expanded=\"false\" class=\"flex justify-between items-center w-full\"> <span class=\"truncate\" data-title></span> <svg class=\"shrink-0 size-4 text-gray-600 \" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"/></svg> </button>",
                                  "toggleClasses": "duration-300 ease-in-out hover:cursor-pointer hover:border-zinc-700 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50 p-2 flex gap-x-2 text-nowrap w-full cursor-pointer bg-white border-2 border-opacity-60 font-bold rounded-full focus:outline-none",
                                  "dropdownClasses": "mt-2 z-50 w-full max-h-72 p-1 space-y-0.5 bg-white border border-gray-200 rounded-lg overflow-hidden overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300",
                                  "optionClasses": "py-2 px-4 w-full text-sm text-nowrap text-gray-800 cursor-pointer hover:bg-gray-100 rounded-lg focus:outline-none focus:bg-gray-100 hs-select-disabled:pointer-events-none hs-select-disabled:opacity-50",
                                  "optionTemplate": "<div class=\"flex justify-between items-center w-full\"><span class=\"truncate\" data-title></span><span class=\"hidden hs-selected:block\"><svg class=\"shrink-0 size-3.5 text-blue-600 dark:text-blue-500\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"/></svg></span></div>",
                                  "extraMarkup": "",
                                  "fixedWidth": true
                              }' class="hidden w-full" multiple>
                                    <option th:each="size: ${T(com.dripify.product.model.enums.Size).values()}"
                                            th:value="${size.name()}"
                                            th:text="${size}"></option>

                                </select>
                                <h1 class="pointer-events-none pl-2 font-bold uppercase absolute bottom-10 left-2 top-1.5">Size</h1>

                            </div>



                        </form>

                    </div>
                </div>


                <div th:if="${productPage.getContent().size() > 0}"
                     class="mt-6 grid gap-x-6 gap-y-10 grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 xl:gap-x-8">
                    <a th:each="product: ${productPage.getContent()}" th:href="@{/products/{id}(id=${product.id})}">

                        <div class="group relative group-hover:cursor-pointer">
                            <img src="https://media-photos.depop.com/b1/5913802/1997839635_8240334744bf42e191e6c596467700fd/P0.jpg"
                                 th:alt="${product.name}"
                                 class="aspect-square w-full rounded-md bg-gray-200 object-cover group-hover:opacity-75 lg:aspect-auto lg:h-80">
                            <div class="mt-4 flex justify-between">
                                <div>
                                    <h3 class="text-sm text-gray-700" th:text="${product.name}">
                                        <span aria-hidden="true" class="absolute inset-0"></span>
                                    </h3>
                                    <p class="mt-1 text-sm text-gray-500" th:text="${product.color}"></p>
                                </div>
                                <p class="text-sm font-medium text-gray-900" th:text="${product.price}"></p>
                            </div>
                        </div>

                    </a>
                </div>
            </div>


            <div th:if="${productPage.getTotalPages() > 1}" class="flex items-baseline justify-center gap-2 mt-20">
                <!-- Previous Page Button -->
                <a th:href="@{${currentPath}(page=${currentPage - 1}, size=10)}"
                   th:classappend="${currentPage == 0} ? 'pointer-events-none opacity-50' : ''"
                   class="mt-6 bg-black bg-opacity-50 text-white p-2 px-4 rounded-full">
                    ❮
                </a>

                <!-- Page Info -->
                <h2 class="font-bold"
                    th:text="${currentPage + 1} + '/' + ${productPage.getTotalPages()} + ' Pages'"></h2>

                <!-- Next Page Button -->
                <a th:href="@{${currentPath}(page=${currentPage + 1}, size=10)}"
                   th:classappend="${currentPage + 1 >= productPage.getTotalPages()} ? 'pointer-events-none opacity-50' : ''"
                   class="mt-6 bg-black bg-opacity-50 text-white p-2 px-4 rounded-full">
                    ❯
                </a>
            </div>


        </div>
    </div>

</div>


<!-- FOOTER -->
<footer th:replace="~{fragments/footer::footer}"></footer>

<button id="scrollToTop"
        class="hidden sm:block fixed bottom-5 right-5 bg-black text-white text-4xl rounded-full p-5 px-8 shadow-lg opacity-0 transition-opacity duration-300">
    ↑
</button>


</body>
</html>
